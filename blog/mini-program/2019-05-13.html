<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序绑定用户方案 优化 | jump-jump-docs</title>
    <meta name="description" content="Welcome to my docs">
    <link rel="icon" href="/img/logo.ico">
    
    <link rel="preload" href="/assets/css/0.styles.2bb79f07.css" as="style"><link rel="preload" href="/assets/js/app.956cf3f6.js" as="script"><link rel="preload" href="/assets/js/13.b2af0e51.js" as="script"><link rel="preload" href="/assets/js/5.db0752e2.js" as="script"><link rel="prefetch" href="/assets/js/10.a8a5287e.js"><link rel="prefetch" href="/assets/js/11.fb2785b8.js"><link rel="prefetch" href="/assets/js/12.b37b7e35.js"><link rel="prefetch" href="/assets/js/14.7889e132.js"><link rel="prefetch" href="/assets/js/15.d9745be6.js"><link rel="prefetch" href="/assets/js/16.305e59f0.js"><link rel="prefetch" href="/assets/js/17.7527f089.js"><link rel="prefetch" href="/assets/js/18.67100fcf.js"><link rel="prefetch" href="/assets/js/19.8c6580e9.js"><link rel="prefetch" href="/assets/js/2.250beb1c.js"><link rel="prefetch" href="/assets/js/20.e4731afe.js"><link rel="prefetch" href="/assets/js/21.d43b0b12.js"><link rel="prefetch" href="/assets/js/22.fce7ec57.js"><link rel="prefetch" href="/assets/js/23.88dc394f.js"><link rel="prefetch" href="/assets/js/3.59851ec8.js"><link rel="prefetch" href="/assets/js/4.5a1a2017.js"><link rel="prefetch" href="/assets/js/6.20862db0.js"><link rel="prefetch" href="/assets/js/7.a611d615.js"><link rel="prefetch" href="/assets/js/8.929ab856.js"><link rel="prefetch" href="/assets/js/9.407e6576.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2bb79f07.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">jump-jump-docs</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/introduction.html" class="nav-link">个人博客</a></div><div class="nav-item"><a href="/algorithm/introduction.html" class="nav-link">常用算法</a></div><div class="nav-item"><a href="/notes/introduction.html" class="nav-link">笔记</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wsafight" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/learn.html" class="nav-link">学习资源</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/introduction.html" class="nav-link">个人博客</a></div><div class="nav-item"><a href="/algorithm/introduction.html" class="nav-link">常用算法</a></div><div class="nav-item"><a href="/notes/introduction.html" class="nav-link">笔记</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wsafight" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/learn.html" class="nav-link">学习资源</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/introduction.html" class="sidebar-link">导读</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>web前端</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/web-front/2019-05-09.html" class="sidebar-link">利用 es6 new.target 来对模拟抽象类</a></li><li><a href="/blog/web-front/2019-05-03.html" class="sidebar-link">谈谈前端工程化 js加载</a></li><li><a href="/blog/web-front/2019-04-21.html" class="sidebar-link">前端 api 请求缓存方案</a></li><li><a href="/blog/web-front/2018-04-28.html" class="sidebar-link">利用 WeakMap 对 Vue 新建数组中的对象赋予 :key</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>小程序</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/mini-program/2019-05-13.html" class="active sidebar-link">小程序绑定用户方案 优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/mini-program/2019-05-13.html#预先绑定类" class="sidebar-link">预先绑定类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/mini-program/2019-05-13.html#功能介绍" class="sidebar-link">功能介绍</a></li><li class="sidebar-sub-header"><a href="/blog/mini-program/2019-05-13.html#技术要点" class="sidebar-link">技术要点</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/mini-program/2019-05-13.html#惰性绑定类" class="sidebar-link">惰性绑定类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/mini-program/2019-05-13.html#功能介绍-2" class="sidebar-link">功能介绍</a></li><li class="sidebar-sub-header"><a href="/blog/mini-program/2019-05-13.html#实践方式" class="sidebar-link">实践方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/mini-program/2019-05-13.html#结语" class="sidebar-link">结语</a></li></ul></li><li><a href="/blog/mini-program/2019-04-27.html" class="sidebar-link">从 VantComponent 谈 小程序维护</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>工程思考</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/engineering/2019-06-12.html" class="sidebar-link">震惊，使用imba.io框架,得到比 vue 快50倍的性能基准</a></li><li><a href="/blog/engineering/2019-06-03.html" class="sidebar-link">探讨奇技淫巧</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="小程序绑定用户方案-优化"><a href="#小程序绑定用户方案-优化" aria-hidden="true" class="header-anchor">#</a> 小程序绑定用户方案 优化</h1> <p>在做过一系列小程序之后，对小程序的登陆鉴权的流程也有一定的理解，类似于 B 端小程序自不必说，要用户信息手机号地址可以一把梭，做一个引导页面进行判断然后要求用户给与绑定，用户自然不会多说什么，毕竟这是企业级别应用。但是当涉及到 C 端小程序时候。想让用户进行绑定，就势必要给与用户便利。这里我列出一些我觉得较为不错的小程序应用方案以供参考。</p> <h2 id="预先绑定类"><a href="#预先绑定类" aria-hidden="true" class="header-anchor">#</a> 预先绑定类</h2> <p>该类小程序在使用之前就需要绑定用户信息。常见于线下门店类功能性小程序。线下操作时有大量的优惠活动来支持小程序的流量。</p> <h3 id="功能介绍"><a href="#功能介绍" aria-hidden="true" class="header-anchor">#</a> 功能介绍</h3> <p>例如 便利蜂。之前在上海经常使用，价格和优惠都非常不错，这类小程序属于线下功能类小程序，内部有抽奖，付款等一系列功能。该小程序第一次打开就先用户直接要求用户绑定信息和地址，考虑到线下门店都会有一定的店员辅助。所以该小程序的绑定操作实际上用户都是可以接受的。图片如下所示。</p> <p><img src="https://image-static.segmentfault.com/182/241/1822419247-5cdaec8ed59be_articlex" alt="便利蜂首次进入"></p> <h3 id="技术要点"><a href="#技术要点" aria-hidden="true" class="header-anchor">#</a> 技术要点</h3> <ul><li>技术1： 使用自定义导航栏让头部可以配置</li></ul> <p>全局配置</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;window&quot;: {
  &quot;navigationStyle&quot;: &quot;custom&quot;
}
</code></pre></div><p>如果微信 app 的版本在 7.0.0之上，我们就可以使用页面级别的配置了。</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;usingComponents&quot;: {},
  &quot;navigationStyle&quot;: &quot;custom&quot;
}
</code></pre></div><p>该配置默认时default，当使用custom时候可以自定义导航，可以在头部配置 loading。</p> <p>第二种这个需要 app 版本，所以如果是想简化，反而在全局下定义，再使用微信官方的组件 <a href="https://github.com/wechat-miniprogram/navigation-bar" target="_blank" rel="noopener noreferrer">avigation-bar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 即可。</p> <ul><li>技术2：使用小程序骨架屏</li></ul> <p>骨架屏方案在后端不能很快给与前端数据时候采用这种方案，亦或者前端可以使用 Service Worker 把上次缓存数据返回到前端，等到从后端获取数据之后刷新页面也是一种方案，但是因为这是第一次打开小程序，所以采用骨架屏是一个很好的方法。</p> <p>采用 <a href="https://github.com/jayZOU/skeleton" target="_blank" rel="noopener noreferrer">小程序骨架屏<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 组件，如果不需要骨架屏动画效果，可以试试直接加载图片作为骨架屏。</p> <h2 id="惰性绑定类"><a href="#惰性绑定类" aria-hidden="true" class="header-anchor">#</a> 惰性绑定类</h2> <p>该类小程序在展示时无需绑定用户信息，但是当用户进行操作时在询问绑定。常用于线上商城等一系列无需专人引导的用户项目。</p> <h3 id="功能介绍-2"><a href="#功能介绍-2" aria-hidden="true" class="header-anchor">#</a> 功能介绍</h3> <p>基本上线上大部分 c 端小程序都采用此做法，功能上倒是没什么可以介绍的，但是实践上却有不同做法。</p> <h3 id="实践方式"><a href="#实践方式" aria-hidden="true" class="header-anchor">#</a> 实践方式</h3> <ul><li>方式 1: 页面跳转 (京东购物)</li></ul> <p>在每个需要绑定的按钮上添加跳转逻辑，如果当前小程序没有绑定，可以跳转到另外一个页面上确认授权。</p> <ul><li>方式2: 按钮控制 (华为商城+)</li></ul> <p>在每个需要绑定按钮上添加 open-type='getuserinfo'，后续可以根据状态变化，切换掉按钮(也可以不切换，因为第二次绑定数据不会跳出组件)。</p> <ul><li>方式3: 遮罩层拦截 (抽奖助手)</li></ul> <p>在需要绑定的页面添加一个 透明模态框，增加以整个页面大小的button。用fixed布局，还可以向下滚动。无论在当前页面点击任何地方都会出现需要绑定选项。</p> <p>组件代码：</p> <div class="language- extra-class"><pre class="language-text"><code>// wxml
&lt;view style=&quot;z-index: {{zIndex}}&quot; class=&quot;mask&quot;&gt;
  &lt;button open-type=&quot;{{ openType }}&quot;
          bindtap=&quot;onClick&quot;
          bindgetuserinfo=&quot;bindGetUserInfo&quot;
          bindgetphonenumber=&quot;bindGetPhoneNumber&quot;
          bindopensetting=&quot;bindOpenSetting&quot;
          binderror=&quot;bindError&quot;
          class=&quot;mask&quot;/&gt;
&lt;/view&gt;

// wxss
.mask{
  position: fixed;
  top: 0;
  bottom:0;
  left:0;
  right:0;
  background-color: inherit;
  opacity: 0;
}
</code></pre></div><p>然后在绑定后令 mask 消失。该方案初看起来不是那么的合适，但是仔细想想却也没什么问题，因为用户99%可能点击所需求的按钮，就算点击到按钮之间的空隙之处跳出要求绑定也没有什么问题。</p> <p>上面方式实际上都没有太大的问题，需要在不同场景下做最合适的选择。</p> <h2 id="结语"><a href="#结语" aria-hidden="true" class="header-anchor">#</a> 结语</h2> <p>人机交互功能是决定计算机系统“友善性”的一个重要因素。学习时候要先把书读厚，再把书读薄，做程序也是一样，如何把系统做的复杂而更加复杂，如何让用户的体验简单而更为简单都不是那么容易的一件事。</p> <div id="vcomments"></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/web-front/2018-04-28.html" class="prev">
          利用 WeakMap 对 Vue 新建数组中的对象赋予 :key
        </a></span> <span class="next"><a href="/blog/mini-program/2019-04-27.html">
          从 VantComponent 谈 小程序维护
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.956cf3f6.js" defer></script><script src="/assets/js/13.b2af0e51.js" defer></script><script src="/assets/js/5.db0752e2.js" defer></script>
  </body>
</html>
